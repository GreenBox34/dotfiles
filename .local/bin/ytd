#!/bin/sh
#
# -*- mode: sh; sh-basic-offset: 2; -*-
# vim: et sw=2
#
# Script Name: ytd
# Description: This script automates yt-dl for easy downloading
# License: BSD 0-Clause License
# Author: https://github.com/GreenBox34

youtube_binary="yt-dlp"
audio_dir="$HOME/Music"
video_dir="$HOME/Videos"
audio_flags="--embed-metadata --prefer-free-formats"
video_flags="--prefer-free-formats --write-auto-subs --embed-metadata \
				   --embed-thumbnail --embed-subs"

usage=$(cat <<_EOF
Usage:
      ytd audio link -- Download audio.
      ytd video link -- Download video.
_EOF
     )

die ()
{
  printf '%s\n' "${@}" 1>&2
  exit 1
}

get_audio ()
{
  cd "$audio_dir" || exit 1
  mkdir -p "${audio_dir}"

  if [ ${#1} -ne 0 ]; then
    ${youtube_binary} ${audio_flags}  -x "${1}"
  else
    die "Provide a link."
  fi
}

get_video ()
{
  cd "$video_dir" || exit 1
  mkdir -p "${video_dir}"

  if [ ${#1} -ne 0 ]; then
    ${youtube_binary} ${video_flags} "${1}"
  else
    die "Provide a link."
  fi
}

case "${1}" in
  "audio")
    get_audio "${2}"
    exit 0
    ;;
  "video")
    get_video "${2}"
    exit 0
    ;;
  *)
    printf "%s\n" "${usage}"
    ;;
esac
